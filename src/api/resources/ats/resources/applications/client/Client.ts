/**
 * This file was auto-generated by Fern from our API Definition.
 */

import * as environments from "../../../../../../environments";
import * as core from "../../../../../../core";
import * as Merge from "../../../../../index";
import * as serializers from "../../../../../../serialization/index";
import { mergeHeaders, mergeOnlyDefinedHeaders } from "../../../../../../core/headers";
import * as errors from "../../../../../../errors/index";

export declare namespace Applications {
    export interface Options {
        environment?: core.Supplier<environments.MergeEnvironment | string>;
        /** Specify a custom URL to connect the client to. */
        baseUrl?: core.Supplier<string>;
        apiKey: core.Supplier<core.BearerToken>;
        /** Override the X-Account-Token header */
        accountToken?: core.Supplier<string | undefined>;
        /** Additional headers to include in requests. */
        headers?: Record<string, string | core.Supplier<string | undefined> | undefined>;
        fetcher?: core.FetchFunction;
    }

    export interface RequestOptions {
        /** The maximum time to wait for a response in seconds. */
        timeoutInSeconds?: number;
        /** The number of times to retry the request. Defaults to 2. */
        maxRetries?: number;
        /** A hook to abort the request. */
        abortSignal?: AbortSignal;
        /** Override the X-Account-Token header */
        accountToken?: string | undefined;
        /** Additional query string parameters to include in the request. */
        queryParams?: Record<string, unknown>;
        /** Additional headers to include in the request. */
        headers?: Record<string, string | core.Supplier<string | undefined> | undefined>;
    }
}

export class Applications {
    protected readonly _options: Applications.Options;

    constructor(_options: Applications.Options) {
        this._options = _options;
    }

    /**
     * Returns a list of `Application` objects.{/* BEGIN_ATS_APPLICATION_FETCH_SUPPORTED_FIELDS * /}<Footer><MergeSupportedFieldsByIntegrationWidget requestType="GET" data="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" /></Footer>{/* END_ATS_APPLICATION_FETCH_SUPPORTED_FIELDS * /}
     *
     * @param {Merge.ats.ListApplicationsRequest} request
     * @param {Applications.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @example
     *     await client.ats.applications.list({
     *         cursor: "cD0yMDIxLTAxLTA2KzAzJTNBMjQlM0E1My40MzQzMjYlMkIwMCUzQTAw"
     *     })
     */
    public list(
        request: Merge.ats.ListApplicationsRequest = {},
        requestOptions?: Applications.RequestOptions,
    ): core.HttpResponsePromise<Merge.ats.PaginatedApplicationList> {
        return core.HttpResponsePromise.fromPromise(this.__list(request, requestOptions));
    }

    private async __list(
        request: Merge.ats.ListApplicationsRequest = {},
        requestOptions?: Applications.RequestOptions,
    ): Promise<core.WithRawResponse<Merge.ats.PaginatedApplicationList>> {
        const {
            candidateId,
            createdAfter,
            createdBefore,
            creditedToId,
            currentStageId,
            cursor,
            expand,
            includeDeletedData,
            includeRemoteData,
            includeShellData,
            jobId,
            modifiedAfter,
            modifiedBefore,
            pageSize,
            rejectReasonId,
            remoteId,
            source,
        } = request;
        const _queryParams: Record<string, string | string[] | object | object[] | null> = {};
        if (candidateId != null) {
            _queryParams["candidate_id"] = candidateId;
        }

        if (createdAfter != null) {
            _queryParams["created_after"] = createdAfter.toISOString();
        }

        if (createdBefore != null) {
            _queryParams["created_before"] = createdBefore.toISOString();
        }

        if (creditedToId != null) {
            _queryParams["credited_to_id"] = creditedToId;
        }

        if (currentStageId != null) {
            _queryParams["current_stage_id"] = currentStageId;
        }

        if (cursor != null) {
            _queryParams["cursor"] = cursor;
        }

        if (expand != null) {
            _queryParams["expand"] = serializers.ats.ListApplicationsRequestExpand.jsonOrThrow(expand, {
                unrecognizedObjectKeys: "strip",
            });
        }

        if (includeDeletedData != null) {
            _queryParams["include_deleted_data"] = includeDeletedData.toString();
        }

        if (includeRemoteData != null) {
            _queryParams["include_remote_data"] = includeRemoteData.toString();
        }

        if (includeShellData != null) {
            _queryParams["include_shell_data"] = includeShellData.toString();
        }

        if (jobId != null) {
            _queryParams["job_id"] = jobId;
        }

        if (modifiedAfter != null) {
            _queryParams["modified_after"] = modifiedAfter.toISOString();
        }

        if (modifiedBefore != null) {
            _queryParams["modified_before"] = modifiedBefore.toISOString();
        }

        if (pageSize != null) {
            _queryParams["page_size"] = pageSize.toString();
        }

        if (rejectReasonId != null) {
            _queryParams["reject_reason_id"] = rejectReasonId;
        }

        if (remoteId !== undefined) {
            _queryParams["remote_id"] = remoteId;
        }

        if (source !== undefined) {
            _queryParams["source"] = source;
        }

        const _response = await (this._options.fetcher ?? core.fetcher)({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.MergeEnvironment.Production,
                "ats/v1/applications",
            ),
            method: "GET",
            headers: mergeHeaders(
                this._options?.headers,
                mergeOnlyDefinedHeaders({
                    Authorization: await this._getAuthorizationHeader(),
                    "X-Account-Token": requestOptions?.accountToken,
                }),
                requestOptions?.headers,
            ),
            queryParameters: { ..._queryParams, ...requestOptions?.queryParams },
            timeoutMs: requestOptions?.timeoutInSeconds != null ? requestOptions.timeoutInSeconds * 1000 : 60000,
            maxRetries: requestOptions?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
        });
        if (_response.ok) {
            return {
                data: serializers.ats.PaginatedApplicationList.parseOrThrow(_response.body, {
                    unrecognizedObjectKeys: "passthrough",
                    allowUnrecognizedUnionMembers: true,
                    allowUnrecognizedEnumValues: true,
                    skipValidation: true,
                    breadcrumbsPrefix: ["response"],
                }),
                rawResponse: _response.rawResponse,
            };
        }

        if (_response.error.reason === "status-code") {
            throw new errors.MergeError({
                statusCode: _response.error.statusCode,
                body: _response.error.body,
                rawResponse: _response.rawResponse,
            });
        }

        switch (_response.error.reason) {
            case "non-json":
                throw new errors.MergeError({
                    statusCode: _response.error.statusCode,
                    body: _response.error.rawBody,
                    rawResponse: _response.rawResponse,
                });
            case "timeout":
                throw new errors.MergeTimeoutError("Timeout exceeded when calling GET /ats/v1/applications.");
            case "unknown":
                throw new errors.MergeError({
                    message: _response.error.errorMessage,
                    rawResponse: _response.rawResponse,
                });
        }
    }

    /**
     * Creates an `Application` object with the given values.
     * For certain integrations, but not all, our API detects duplicate candidates and will associate applications with existing records in the third-party. New candidates are created and automatically linked to the application.
     *
     * See our [Help Center article](https://help.merge.dev/en/articles/10012366-updates-to-post-applications-oct-2024) for detailed support per integration.
     * {/* BEGIN_ATS_APPLICATION_CREATE_SUPPORTED_FIELDS * /}<Footer><MergeSupportedFieldsByIntegrationWidget requestType="POST" data="H4sIAAAAAAAAE+WZa3PaOBSG/wqjjxkuTUi2DTM7O9xCoMGkgTTNdjoaWToxAllyJBkCnf73HRuThJZcOhEku/sNC/m19fg9OufY3xElFgKlZ6iCiDUoj0LFQKAKqkaR4JRYriTKIxJxj4SAKqgLOoBcddDPVU/bKI9MHEVKW2BHHAQzxxquUAWVwmRaIZb8igMrDTU3JaomoEkApdtTClfpOSiPBJdjYFVKVSztYyKLiQWymPnTYfK3sSiPImKMHWoVB8MzuI7BPKQ5lmoqgAVQ8IlZ3JmAEKQlosCIJaV7SgW9kFo3lqyBgQALrEEsaYAFmqDLrjq0NjKVUmkIIiqmd1BkMCmBLBFtORVgSgflw733hweFTCW9+l84EH/u7oyufeW/38EBFZjEO90BvfEG7ak3Cva9+v6NNz8/8ObjuTcav9vBAdnpDroHvcFludeo7vbWTMD9P74cfq41ah1vh86bZW90OfUGdLc7oGN/3i53WnTaOf50480v97qN87I3aB50Wmq3Vz8z3fqZ6laLRZRHXFoIdOoQgypfv98fyMxSNUN/tjq1HZIA7iFZPA8S8UIU+4LToikXSUjmSpKpKVIVlkJgnJRSKdy/jokGfKIChcvxpwsymRYjGSzpcyVv0aMKanrHVa/ebKw6ojohXBBfAKpYHcMvFkaVr4gk7geGSeImSiTjjFhIfmtg3ALDViVHsdYgLTY2WVQejZSP8khDqCxgzpLwoBpAchng1CdcSUykmYJOHGNUrCmgb8kp1zHXwE6JJiHY5O/K15ULJ9LffuTXUp4QG2tww/lUEHuldJiJboTuz+u6j+ylMGok9JU6PnNDY6l233jFUbRNwz1tsWe76CFksRBDpaUjA2kVgbYzvNu+E8O3o3stkKA5vRspZ2xvB/aXN7Rx87mEu17tCeS5M6A65jZJObm6UDFz8xD8TB/rO31ME31sFrT7tUbUHk/+u4jrQtHxVOmxG6K3chvfCja5O9ZVCGDdEMmsi9tUSdyTYrblTPyEsZ6F6h4GHCWzzNrBYkS0laDx7bnpFR5irCVoY5WE3IAIkPaES1cuvNN+vZT02yH8ECgN4pfH8NK6JRPNtrnXt+RLI7YZCeWohE6lNglmkztXK6mjhyo2jvxyp/fMQPKqg/bn5tZbiRFQizUQk/bhi+Ol2u9k0UfQHhPtq1gnTb3bWMyElyUHu2zVL/7u/uusx+vtrmMy7URyW6HotgR7BFSHzOeuOq+F1krDf/GJdhtdtuX+6w02/B3lVxkD7daTI+WTRHVrtlwhu4G+tqP8CXdVX2RiK8li2xvZ7xnoubXtQhPbWfSE7U5g4spzqdRKcKvL4MOsdvG/CO4H+PY0oWLRMyg3mFOprTasL841D7DpV09z/ZhSMOaIUKu0cUNoVXPFkTX6RQVH794CspfY7pGA7odE26yNB2dEV0VXkI4+TE6umhev35VtM6yTIIS521y90HyLnz6e3a9syNMDIKElXChHmepO7+19A3ht1ucfW7lTrZYvsXnqRgfMzz+2lj3jXu2a3fT4dp2+wap+Tf1FlreaPF9t8dP1/4XS43RtTmgv1VZ26t5ECE8cvlLy20YTlSybEUev1pb7cib6Flp6VwjXf3L59uMfzxJrgTwiAAA=" /></Footer>{/* END_ATS_APPLICATION_CREATE_SUPPORTED_FIELDS * /}
     *
     * @param {Merge.ats.ApplicationEndpointRequest} request
     * @param {Applications.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @example
     *     await client.ats.applications.create({
     *         model: {},
     *         remoteUserId: "remote_user_id"
     *     })
     */
    public create(
        request: Merge.ats.ApplicationEndpointRequest,
        requestOptions?: Applications.RequestOptions,
    ): core.HttpResponsePromise<Merge.ats.ApplicationResponse> {
        return core.HttpResponsePromise.fromPromise(this.__create(request, requestOptions));
    }

    private async __create(
        request: Merge.ats.ApplicationEndpointRequest,
        requestOptions?: Applications.RequestOptions,
    ): Promise<core.WithRawResponse<Merge.ats.ApplicationResponse>> {
        const { isDebugMode, runAsync, ..._body } = request;
        const _queryParams: Record<string, string | string[] | object | object[] | null> = {};
        if (isDebugMode != null) {
            _queryParams["is_debug_mode"] = isDebugMode.toString();
        }

        if (runAsync != null) {
            _queryParams["run_async"] = runAsync.toString();
        }

        const _response = await (this._options.fetcher ?? core.fetcher)({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.MergeEnvironment.Production,
                "ats/v1/applications",
            ),
            method: "POST",
            headers: mergeHeaders(
                this._options?.headers,
                mergeOnlyDefinedHeaders({
                    Authorization: await this._getAuthorizationHeader(),
                    "X-Account-Token": requestOptions?.accountToken,
                }),
                requestOptions?.headers,
            ),
            contentType: "application/json",
            queryParameters: { ..._queryParams, ...requestOptions?.queryParams },
            requestType: "json",
            body: serializers.ats.ApplicationEndpointRequest.jsonOrThrow(_body, { unrecognizedObjectKeys: "strip" }),
            timeoutMs: requestOptions?.timeoutInSeconds != null ? requestOptions.timeoutInSeconds * 1000 : 60000,
            maxRetries: requestOptions?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
        });
        if (_response.ok) {
            return {
                data: serializers.ats.ApplicationResponse.parseOrThrow(_response.body, {
                    unrecognizedObjectKeys: "passthrough",
                    allowUnrecognizedUnionMembers: true,
                    allowUnrecognizedEnumValues: true,
                    skipValidation: true,
                    breadcrumbsPrefix: ["response"],
                }),
                rawResponse: _response.rawResponse,
            };
        }

        if (_response.error.reason === "status-code") {
            throw new errors.MergeError({
                statusCode: _response.error.statusCode,
                body: _response.error.body,
                rawResponse: _response.rawResponse,
            });
        }

        switch (_response.error.reason) {
            case "non-json":
                throw new errors.MergeError({
                    statusCode: _response.error.statusCode,
                    body: _response.error.rawBody,
                    rawResponse: _response.rawResponse,
                });
            case "timeout":
                throw new errors.MergeTimeoutError("Timeout exceeded when calling POST /ats/v1/applications.");
            case "unknown":
                throw new errors.MergeError({
                    message: _response.error.errorMessage,
                    rawResponse: _response.rawResponse,
                });
        }
    }

    /**
     * Returns an `Application` object with the given `id`.{/* BEGIN_ATS_APPLICATION_FETCH_SUPPORTED_FIELDS * /}<Footer><MergeSupportedFieldsByIntegrationWidget requestType="GET" data="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" /></Footer>{/* END_ATS_APPLICATION_FETCH_SUPPORTED_FIELDS * /}
     *
     * @param {string} id
     * @param {Merge.ats.RetrieveApplicationsRequest} request
     * @param {Applications.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @example
     *     await client.ats.applications.retrieve("id")
     */
    public retrieve(
        id: string,
        request: Merge.ats.RetrieveApplicationsRequest = {},
        requestOptions?: Applications.RequestOptions,
    ): core.HttpResponsePromise<Merge.ats.Application> {
        return core.HttpResponsePromise.fromPromise(this.__retrieve(id, request, requestOptions));
    }

    private async __retrieve(
        id: string,
        request: Merge.ats.RetrieveApplicationsRequest = {},
        requestOptions?: Applications.RequestOptions,
    ): Promise<core.WithRawResponse<Merge.ats.Application>> {
        const { expand, includeRemoteData, includeShellData } = request;
        const _queryParams: Record<string, string | string[] | object | object[] | null> = {};
        if (expand != null) {
            _queryParams["expand"] = serializers.ats.RetrieveApplicationsRequestExpand.jsonOrThrow(expand, {
                unrecognizedObjectKeys: "strip",
            });
        }

        if (includeRemoteData != null) {
            _queryParams["include_remote_data"] = includeRemoteData.toString();
        }

        if (includeShellData != null) {
            _queryParams["include_shell_data"] = includeShellData.toString();
        }

        const _response = await (this._options.fetcher ?? core.fetcher)({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.MergeEnvironment.Production,
                `ats/v1/applications/${encodeURIComponent(id)}`,
            ),
            method: "GET",
            headers: mergeHeaders(
                this._options?.headers,
                mergeOnlyDefinedHeaders({
                    Authorization: await this._getAuthorizationHeader(),
                    "X-Account-Token": requestOptions?.accountToken,
                }),
                requestOptions?.headers,
            ),
            queryParameters: { ..._queryParams, ...requestOptions?.queryParams },
            timeoutMs: requestOptions?.timeoutInSeconds != null ? requestOptions.timeoutInSeconds * 1000 : 60000,
            maxRetries: requestOptions?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
        });
        if (_response.ok) {
            return {
                data: serializers.ats.Application.parseOrThrow(_response.body, {
                    unrecognizedObjectKeys: "passthrough",
                    allowUnrecognizedUnionMembers: true,
                    allowUnrecognizedEnumValues: true,
                    skipValidation: true,
                    breadcrumbsPrefix: ["response"],
                }),
                rawResponse: _response.rawResponse,
            };
        }

        if (_response.error.reason === "status-code") {
            throw new errors.MergeError({
                statusCode: _response.error.statusCode,
                body: _response.error.body,
                rawResponse: _response.rawResponse,
            });
        }

        switch (_response.error.reason) {
            case "non-json":
                throw new errors.MergeError({
                    statusCode: _response.error.statusCode,
                    body: _response.error.rawBody,
                    rawResponse: _response.rawResponse,
                });
            case "timeout":
                throw new errors.MergeTimeoutError("Timeout exceeded when calling GET /ats/v1/applications/{id}.");
            case "unknown":
                throw new errors.MergeError({
                    message: _response.error.errorMessage,
                    rawResponse: _response.rawResponse,
                });
        }
    }

    /**
     * Updates the `current_stage` field of an `Application` object{/* BEGIN_ATS_APPLICATION_CREATE_SUPPORTED_FIELDS * /}<Footer><MergeSupportedFieldsByIntegrationWidget requestType="POST" data="H4sIAAAAAAAAE+WZa3PaOBSG/wqjjxkuTUi2DTM7O9xCoMGkgTTNdjoaWToxAllyJBkCnf73HRuThJZcOhEku/sNC/m19fg9OufY3xElFgKlZ6iCiDUoj0LFQKAKqkaR4JRYriTKIxJxj4SAKqgLOoBcddDPVU/bKI9MHEVKW2BHHAQzxxquUAWVwmRaIZb8igMrDTU3JaomoEkApdtTClfpOSiPBJdjYFVKVSztYyKLiQWymPnTYfK3sSiPImKMHWoVB8MzuI7BPKQ5lmoqgAVQ8IlZ3JmAEKQlosCIJaV7SgW9kFo3lqyBgQALrEEsaYAFmqDLrjq0NjKVUmkIIiqmd1BkMCmBLBFtORVgSgflw733hweFTCW9+l84EH/u7oyufeW/38EBFZjEO90BvfEG7ak3Cva9+v6NNz8/8ObjuTcav9vBAdnpDroHvcFludeo7vbWTMD9P74cfq41ah1vh86bZW90OfUGdLc7oGN/3i53WnTaOf50480v97qN87I3aB50Wmq3Vz8z3fqZ6laLRZRHXFoIdOoQgypfv98fyMxSNUN/tjq1HZIA7iFZPA8S8UIU+4LToikXSUjmSpKpKVIVlkJgnJRSKdy/jokGfKIChcvxpwsymRYjGSzpcyVv0aMKanrHVa/ebKw6ojohXBBfAKpYHcMvFkaVr4gk7geGSeImSiTjjFhIfmtg3ALDViVHsdYgLTY2WVQejZSP8khDqCxgzpLwoBpAchng1CdcSUykmYJOHGNUrCmgb8kp1zHXwE6JJiHY5O/K15ULJ9LffuTXUp4QG2tww/lUEHuldJiJboTuz+u6j+ylMGok9JU6PnNDY6l233jFUbRNwz1tsWe76CFksRBDpaUjA2kVgbYzvNu+E8O3o3stkKA5vRspZ2xvB/aXN7Rx87mEu17tCeS5M6A65jZJObm6UDFz8xD8TB/rO31ME31sFrT7tUbUHk/+u4jrQtHxVOmxG6K3chvfCja5O9ZVCGDdEMmsi9tUSdyTYrblTPyEsZ6F6h4GHCWzzNrBYkS0laDx7bnpFR5irCVoY5WE3IAIkPaES1cuvNN+vZT02yH8ECgN4pfH8NK6JRPNtrnXt+RLI7YZCeWohE6lNglmkztXK6mjhyo2jvxyp/fMQPKqg/bn5tZbiRFQizUQk/bhi+Ol2u9k0UfQHhPtq1gnTb3bWMyElyUHu2zVL/7u/uusx+vtrmMy7URyW6HotgR7BFSHzOeuOq+F1krDf/GJdhtdtuX+6w02/B3lVxkD7daTI+WTRHVrtlwhu4G+tqP8CXdVX2RiK8li2xvZ7xnoubXtQhPbWfSE7U5g4spzqdRKcKvL4MOsdvG/CO4H+PY0oWLRMyg3mFOprTasL841D7DpV09z/ZhSMOaIUKu0cUNoVXPFkTX6RQVH794CspfY7pGA7odE26yNB2dEV0VXkI4+TE6umhev35VtM6yTIIS521y90HyLnz6e3a9syNMDIKElXChHmepO7+19A3ht1ucfW7lTrZYvsXnqRgfMzz+2lj3jXu2a3fT4dp2+wap+Tf1FlreaPF9t8dP1/4XS43RtTmgv1VZ26t5ECE8cvlLy20YTlSybEUev1pb7cib6Flp6VwjXf3L59uMfzxJrgTwiAAA=" /></Footer>{/* END_ATS_APPLICATION_CREATE_SUPPORTED_FIELDS * /}
     *
     * @param {string} id
     * @param {Merge.ats.UpdateApplicationStageRequest} request
     * @param {Applications.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @example
     *     await client.ats.applications.changeStageCreate("id")
     */
    public changeStageCreate(
        id: string,
        request: Merge.ats.UpdateApplicationStageRequest = {},
        requestOptions?: Applications.RequestOptions,
    ): core.HttpResponsePromise<Merge.ats.ApplicationResponse> {
        return core.HttpResponsePromise.fromPromise(this.__changeStageCreate(id, request, requestOptions));
    }

    private async __changeStageCreate(
        id: string,
        request: Merge.ats.UpdateApplicationStageRequest = {},
        requestOptions?: Applications.RequestOptions,
    ): Promise<core.WithRawResponse<Merge.ats.ApplicationResponse>> {
        const { isDebugMode, runAsync, ..._body } = request;
        const _queryParams: Record<string, string | string[] | object | object[] | null> = {};
        if (isDebugMode != null) {
            _queryParams["is_debug_mode"] = isDebugMode.toString();
        }

        if (runAsync != null) {
            _queryParams["run_async"] = runAsync.toString();
        }

        const _response = await (this._options.fetcher ?? core.fetcher)({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.MergeEnvironment.Production,
                `ats/v1/applications/${encodeURIComponent(id)}/change-stage`,
            ),
            method: "POST",
            headers: mergeHeaders(
                this._options?.headers,
                mergeOnlyDefinedHeaders({
                    Authorization: await this._getAuthorizationHeader(),
                    "X-Account-Token": requestOptions?.accountToken,
                }),
                requestOptions?.headers,
            ),
            contentType: "application/json",
            queryParameters: { ..._queryParams, ...requestOptions?.queryParams },
            requestType: "json",
            body: serializers.ats.UpdateApplicationStageRequest.jsonOrThrow(_body, { unrecognizedObjectKeys: "strip" }),
            timeoutMs: requestOptions?.timeoutInSeconds != null ? requestOptions.timeoutInSeconds * 1000 : 60000,
            maxRetries: requestOptions?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
        });
        if (_response.ok) {
            return {
                data: serializers.ats.ApplicationResponse.parseOrThrow(_response.body, {
                    unrecognizedObjectKeys: "passthrough",
                    allowUnrecognizedUnionMembers: true,
                    allowUnrecognizedEnumValues: true,
                    skipValidation: true,
                    breadcrumbsPrefix: ["response"],
                }),
                rawResponse: _response.rawResponse,
            };
        }

        if (_response.error.reason === "status-code") {
            throw new errors.MergeError({
                statusCode: _response.error.statusCode,
                body: _response.error.body,
                rawResponse: _response.rawResponse,
            });
        }

        switch (_response.error.reason) {
            case "non-json":
                throw new errors.MergeError({
                    statusCode: _response.error.statusCode,
                    body: _response.error.rawBody,
                    rawResponse: _response.rawResponse,
                });
            case "timeout":
                throw new errors.MergeTimeoutError(
                    "Timeout exceeded when calling POST /ats/v1/applications/{id}/change-stage.",
                );
            case "unknown":
                throw new errors.MergeError({
                    message: _response.error.errorMessage,
                    rawResponse: _response.rawResponse,
                });
        }
    }

    /**
     * Returns metadata for `Application` POSTs.{/* BEGIN_ATS_APPLICATION_FETCH_SUPPORTED_FIELDS * /}<Footer><MergeSupportedFieldsByIntegrationWidget requestType="GET" data="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" /></Footer>{/* END_ATS_APPLICATION_FETCH_SUPPORTED_FIELDS * /}
     *
     * @param {Merge.ats.MetaPostRetrieveApplicationsRequest} request
     * @param {Applications.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @example
     *     await client.ats.applications.metaPostRetrieve()
     */
    public metaPostRetrieve(
        request: Merge.ats.MetaPostRetrieveApplicationsRequest = {},
        requestOptions?: Applications.RequestOptions,
    ): core.HttpResponsePromise<Merge.ats.MetaResponse> {
        return core.HttpResponsePromise.fromPromise(this.__metaPostRetrieve(request, requestOptions));
    }

    private async __metaPostRetrieve(
        request: Merge.ats.MetaPostRetrieveApplicationsRequest = {},
        requestOptions?: Applications.RequestOptions,
    ): Promise<core.WithRawResponse<Merge.ats.MetaResponse>> {
        const { applicationRemoteTemplateId } = request;
        const _queryParams: Record<string, string | string[] | object | object[] | null> = {};
        if (applicationRemoteTemplateId != null) {
            _queryParams["application_remote_template_id"] = applicationRemoteTemplateId;
        }

        const _response = await (this._options.fetcher ?? core.fetcher)({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.MergeEnvironment.Production,
                "ats/v1/applications/meta/post",
            ),
            method: "GET",
            headers: mergeHeaders(
                this._options?.headers,
                mergeOnlyDefinedHeaders({
                    Authorization: await this._getAuthorizationHeader(),
                    "X-Account-Token": requestOptions?.accountToken,
                }),
                requestOptions?.headers,
            ),
            queryParameters: { ..._queryParams, ...requestOptions?.queryParams },
            timeoutMs: requestOptions?.timeoutInSeconds != null ? requestOptions.timeoutInSeconds * 1000 : 60000,
            maxRetries: requestOptions?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
        });
        if (_response.ok) {
            return {
                data: serializers.ats.MetaResponse.parseOrThrow(_response.body, {
                    unrecognizedObjectKeys: "passthrough",
                    allowUnrecognizedUnionMembers: true,
                    allowUnrecognizedEnumValues: true,
                    skipValidation: true,
                    breadcrumbsPrefix: ["response"],
                }),
                rawResponse: _response.rawResponse,
            };
        }

        if (_response.error.reason === "status-code") {
            throw new errors.MergeError({
                statusCode: _response.error.statusCode,
                body: _response.error.body,
                rawResponse: _response.rawResponse,
            });
        }

        switch (_response.error.reason) {
            case "non-json":
                throw new errors.MergeError({
                    statusCode: _response.error.statusCode,
                    body: _response.error.rawBody,
                    rawResponse: _response.rawResponse,
                });
            case "timeout":
                throw new errors.MergeTimeoutError("Timeout exceeded when calling GET /ats/v1/applications/meta/post.");
            case "unknown":
                throw new errors.MergeError({
                    message: _response.error.errorMessage,
                    rawResponse: _response.rawResponse,
                });
        }
    }

    protected async _getAuthorizationHeader(): Promise<string> {
        return `Bearer ${await core.Supplier.get(this._options.apiKey)}`;
    }
}
